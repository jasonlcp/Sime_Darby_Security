<template>
  <div class="page" data-name="home">
    <!-- Top Navbar -->
    <div class="navbar no-hairline no-shadow">
      <div class="navbar-inner navbar-inner-large">
        <!--<div class="title sliding">Elmina Resident</div>-->
        <div class="right">
          <a href="/profile/" class="link icon-only panel-open" data-panel="right">
            <i class="icon f7-icons ">person_round_fill</i>
          </a>
        </div>
        <div class="title-large">
          <div class="title-large-inner">
            <div class="block">
              <small>Welcome</small>
              <h2 class="display-name">{{name}}</h2>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="main-toolbar toolbar tabbar tabbar-labels toolbar-top no-shadow no-hairline elevation-3">
      <div class="toolbar-inner">
        <a href="/schedule/" class="tab-link">
          <i class="icon f7-icons">calendar_today</i>
          <span class="tabbar-label">Visitor Entry</span>
        </a>
        <a href="/visitor-list/" class="tab-link tab-link">
          <i class="icon f7-icons">persons_round</i>
          <span class="tabbar-label">My Visitors</span>
        </a>
        <a href="/pay-bills/" class="tab-link">
          <i class="icon f7-icons">money_dollar_round</i>
          <span class="tabbar-label">Pay Bills</span>
        </a>
        <a href="/notification/" class="tab-link">
          <i class="icon f7-icons">photos<span class="badge color-red">3</span></i>
          <span class="tabbar-label">Notification</span>
        </a>
      </div>
    </div>
    <!-- Scrollable page content-->
    <div class="page-content ptr-content">
      <div class="ptr-preloader">
        <div class="preloader"></div>
        <div class="ptr-arrow"></div>
      </div>
      <!--Service-->
      <div class="block-title">
        <h3>Services</h3>
      </div>
      <div class="block margin-btm-16">
        <div class="row">
          <div class="col-25">
            <a href="/family-list/" class="service-link">
              <i class="icon f7-icons">persons_round</i>
              <p>Family</p>
            </a>
          </div>
          <div class="col-25">
            <a href="/visits/" class="service-link">
              <i class="icon f7-icons">graph_round</i>
              <p>Visits</p>
            </a>
          </div>
          <div class="col-25">
            <a href="/bills/" class="service-link">
              <i class="icon f7-icons">document_text</i>
              <p>Bills</p>
            </a>
          </div>
          <div class="col-25">
            <a href="#" class="service-link">
              <i class="icon f7-icons">document_check</i>
              <p>Payment</p>
            </a>
          </div>
        </div>
      </div>
      <!--Properties-->
      <div class="block-title margin-top-16">
        <h3>Properties</h3>
      </div>

      <div class="block margin-btm-16">
        <div class="swiper-container swiper-init" data-space-between="20" data-slides-per-view="auto">
          <!-- Slides wrapper -->
          <div class="swiper-wrapper ">
            <!-- Slides -->
            {{#each properties}}
            <div class="swiper-slide">
              <a href="/property/">
                <div class="card card-header-pic">
                  <div style="background-image:url({{street.area.thumbnail}})" class="card-header align-items-flex-end">
                    {{name}}</div>
                  <div class="card-footer"><span>{{street.area.name}},{{street.name}} <i
                        class="icon f7-icons em-1"></span>chevron_right</i></div>
                </div>
              </a>
            </div>
            {{else}}
            <div class="swiper-slide">
              <div class="card">
                <div class="card-content card-content-padding"><span>No Property Found!</span></div>
              </div>
            </div>
            {{/each}}
          </div>
        </div>
      </div>

      <!--Properties-->
      <div class="block-title margin-top-16">
        <h3 style="float:left">Announcements</h3>
        <div style="float:right;margin-top:1em; margin-bottom:1em;">
          <a class="link" href="/announcement-list/"> More</a>
        </div>
      </div>
      <div class="block">
        <div class="swiper-container swiper-init" data-space-between="20" data-slides-per-view="auto">
          <!-- Slides wrapper -->
          <div class="swiper-wrapper ">
            <!-- Slides -->
            {{#each announcements}}
            <div class="swiper-slide">
              <a href="/announcement/">
                <div class="card card-header-pic">
                  <div style="background-image:url({{thumbnail}})" class="card-header align-items-flex-end">{{title}}
                  </div>
                  <div class="card-footer">Find Out More <i class="icon f7-icons em-1">chevron_right</i></div>
                </div>
              </a>
            </div>
            {{else}}
            <div class="swiper-slide">
              <div class="card">
                <div class="card-content card-content-padding">No announcements at the moment.</div>
              </div>
            </div>
            {{/each}}
          </div>
        </div>
      </div>
    </div>
  </div>
</template>
<style scoped>
  .navbar .title-large {
    border-radius: 0px 0px 10% 10%;
    text-transform: capitalize;
    --f7-navbar-large-title-height: 140px;

  }

  .ptr-preloader {
    --f7-ptr-top: -30px;
  }

  .ptr-refreshing .ptr-preloader {
    transform: translate3d(0, 106px, 0);
  }

  .page-content {
    --f7-page-navbar-offset: calc(var(--f7-navbar-height) + 140px);
  }

  .navbar .title-large .block {
    color: var(--f7-navbar-text-color);
  }

  .swiper-slide {
    width: 80%;
  }

  .em-1 {
    font-size: 1em;
  }

  .card-header-pic .card-header {
    height: 30vw;
    background-size: cover;
    background-position: center;
    color: #fff;
  }

  .card-footer span {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .col-25 {
    text-align: center;
  }

  .margin-btm-16 {
    margin-bottom: 16px;
  }

  .margin-top-16 {
    margin-top: 16px;
  }

  .service-link p {
    margin: 0px;
  }

  .display-name {
    margin: 0px;
  }

  .main-toolbar.toolbar .toolbar-inner .tab-link .icon {
    color: var(--f7-theme-color-tint);
  }

  .navbar~.main-toolbar.toolbar {
    z-index: 501;
    top: calc(var(--f7-navbar-height) + 112px);
    width: calc(100% - 16px);
    margin-left: 8px;
    --f7-navbar-large-title-height: 140px;
    transform: translate3d(0px, calc(-0.8 * var(--f7-navbar-large-collapse-progress) * var(--f7-navbar-large-title-height)), 0);
    will-change: transform, width, margin, top;
    transition-property: transform, width, margin, top;
    border-radius: 9px;
    border: 1px solid #fff;
  }

  .service-link p {
    color: var(--f7-tabbar-link-inactive-color);
  }

  .main-toolbar.toolbar-top.tabbar-labels~* {
    --f7-page-toolbar-top-offset: 0px;
  }
</style>
<script>
  export default {
    data: function () {
      var auth = this.$app.methods.getUser();
      var name = null;
      if (auth) {
        name = auth.user.first_name + " " + auth.user.last_name
      }
      return {
        name: name,
        announcements: null,
        properties: null,
      }
    },
    on: {
      pageInit: function () {
        var $$ = this.$$;
        var app = this.$app;
        var auth = this.$app.methods.getUser();
        var property_swiper;
        var router = this.$router;
        var self = this;
        if (!auth) {
          router.navigate('/login/');
          router.clearPreviousHistory();
        } else {
          this.$app.methods.getAnnouncements();
          this.$app.methods.getProperties();
        }
        $$('.navbar').on('navbar:collapse', function () {
          $$('.main-toolbar.toolbar').css({
            'margin-left': '0px',
            'width': '100%',
            'border-radius': '0px',
          });
        });
        $$('.navbar').on('navbar:expand', function () {
          $$('.main-toolbar.toolbar').css({
            'margin-left': '8px',
            'width': 'calc(100% - 16px)',
            'border-radius': '9px',
          });
        });

      }
    }
  }
</script>